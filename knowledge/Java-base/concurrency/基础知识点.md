# 基础知识点 #

## 先行发生原则 ##

happens-before

1. 单线程原则
   - 单线程中的操作，一个操作happens-before其之后的操作。
2. 加锁解锁原则
   - 一个锁的加锁操作happens-before一个锁的解锁及以后的操作。
3. volatile原则
   - volatile的字段的写操作，happens-before这个字段的读操作。
4. 传递性
   - happens-before具有传递性。
5. start
   - A线程启动B线程，A的启动操作happens-before B线程中的所有操作。
6. join
   - A线程调用B线程的join方法，B线程中剩余的操作happens-before A线程的join方法的返回。

## Java内存模型抽象 ##

![jmm内存模型](../imgs/jmm.png)

1. 整个Java进程有一个主内存，这个内存区域中存放所有的共享变量。

2. 除了主内存之外，每一个线程都会对应一个本地内存的区域。

3. 当线程需要取用变量的时候，从主内存中取得变量的副本，放置在本地内存中。

## 内存屏障 ##

为了在JMM体系中从底层保持内存可见性，Java代码在编译成底层指令的时候会添加内存屏障。

![内存屏障](../imgs/barriers.jpg)
